# REQ-001-A.MT邮件冷发系统V2.0需求文档

## 一、项目概述

### 项目目标
重构现有邮件冷发平台，打造集邮箱数据管理、批量任务系统、内容管理、发信路由机制、私域管理于一体的全流程邮件营销系统，提升邮件转化率与系统可维护性。并新增联系人私域管理，包括联系人的社媒账号信息（通过三方数据爬虫补充）、联系人历史邮件发送和互动行为记录、联系人标签管理（未来支持智能打标）

### 目标用户
- 电商/品牌营销团队
- TikTok/社交媒体红人运营人员
- 需要进行大规模邮件触达的企业用户

### 使用场景
- 红人/KOL批量触达与内容投放
- 用户标签化精准营销
- 多通道邮件发送管理
- 客户生命周期维护与私域转化

## 二、MVP功能列表（方案一：基础增强型）

### 1. 邮箱数据管理模块

#### 1.1 联系人管理
- **功能编号**: F01
- **功能描述**: 提供多维度联系人导入、管理与标签分类
- **详细功能**:
  - 支持CSV/Excel批量导入，自动字段匹配
  - 联系人导入字段：id、用户名、邮箱、TikTok_uniqued_id、Ins_id、Youtobe_id、自定义字段1、自定义字段2、自定义字段3、自定义字段4、自定义字段5
  - 联系人去重与合并
  - 联系人详情页（含历史互动记录）
  - 联系人批量操作（删除/移动/打标）

#### 1.2 标签体系
- **功能编号**: F02
- **功能描述**: 构建多层级标签体系，支持精准人群定位
- **详细功能**:
  - 自定义多级标签（支持层级嵌套，如：KOC→美国→女性→时尚类）
  - 自定义多个平行标签
  - 标签规则创建（基于用户属性自动分类）
  - 标签组合筛选（支持"与"/"或"/"非"逻辑）
  - 标签批量操作（合并/拆分/重命名）
  - 基于标签查看人群列表

### 2. 批量任务系统

#### 2.1 任务创建
- **功能编号**: F03
- **功能描述**: 提供灵活的任务创建与配置界面
- **详细功能**:
  - 任务基础信息设置（名称、描述）
  - 目标人群选择（基于标签组合，标签组合支持“与”/“或”/“非”逻辑）
  - 发送内容选择（支持固定模板和随机模板）
  - 发送配置（发件人设置）
  - 定时发送与分批设置

#### 2.2 任务调度与监控
- **功能编号**: F04
- **功能描述**: 智能调度任务执行并实时监控状态
- **详细功能**:
  - 多任务并行处理
  - 任务执行状态实时监控
  - 失败不进行自动重试
  - 任务暂停/恢复/取消
  - 发送速率控制与流量平滑
  - 任务根据可用的发信服务自动路由

#### 2.3 任务数据分析
- **功能编号**: F05
- **功能描述**: 提供任务执行效果的多维度分析
- **详细功能**:
  - 基础数据统计（发送量/送达率/打开率/点击率）
  - 送达统计：收信箱返回成功
  - 打开统计：邮件正文加入透明像素点，加载后记录返回邮件ID，标识为打开，可统计打开次数和打开人数（同一邮箱地址为同一人）
  - 点击统计：邮件设定的跳转链接，在跳转前都需经过中转页，跳转时带上邮件ID和目标跳转地址，通过中转页的加载识别邮件点击，可统计点击次数和点击人数（同一邮箱地址）
  - 回复统计：以批量发送邮件的发信人名称（非完整邮箱地址）汇总回复邮件数
  - 任务回复率追踪：可以通过邮件回复中，引用往来邮件中的带有发信邮件ID像素点的内容，判断是同一个任务的回复（如果对方回复时删除了之前的内容，那么就统计不到该任务的回复了，存在不准，仅作参考）
  - 退订追踪：邮件模板支持退订按钮，收信人可点击退订按钮跳转至退订页面，选择退订理由并提交
  - 打开/点击/回复/退订/错误邮箱列表，针对邮箱列表，可创建标签进行二次营销或者过滤标签
  - 标签维度分析（不同标签群体效果对比）
  - 任务对比分析
  - 发信服务对比分析（按天，管理员权限可看）

#### 2.4 多轮营销任务创建
- **功能编号**: F06
- **功能描述**: 基于收信人的行为，进行T+N多轮营销
- **详细功能**:
  - 支持指定多轮营销计划（最多5轮，每一轮可创建3个子任务）
    - 营销时间点
    - 人群筛选
        - 本次任务全部人群
        - 包含已打开/已点击/已回复人群
        - 剔除已打开/已点击/已回复人群
        - 默认剔除已退订人群
    - 本轮邮件模板

### 3. 邮件内容管理模块

#### 3.1 正文模板管理-用户级
- **功能编号**: F07
- **功能描述**: 提供邮件模板的创建、编辑与管理功能
- **详细功能**:
  - 可视化模板编辑器
  - HTML源码编辑模式
  - AI模式内容（详见3.2）
  - 变量插入功能（{{user}}等）
  - 变量定义模块，支持定义变量名和对应的表+字段名
  - 模板分类与标签管理
  
#### 3.2 AI内容模板
- **功能编号**: F08
- **功能描述**: 支持针对收信人行为，通过AI模板prompt + 自定义变量，逐一生成个性化邮件内容
- **详细功能**:
  - 模板统一prompt
  - prompt支持上传发信人变量，如名称、社媒签名、社媒内容、个性化标签等
  - 针对AI内容模板，在每次发送前，针对每个发信人都调用AI动态生成邮件内容

#### 3.3 底部模板管理-系统级（管理员权限）
- **功能编号**: F09
- **功能描述**: 按系统用户级，统一增加邮件HTML模板，并通过{{mail}} 变量，放置正文内容位置。通常场景时针对系统用户，强制性加上退订引导，或者强logo背书，避免收信人大量邮件投诉
- **详细功能**:
  - 模板支持HTML格式
  - 正文通过{{mail}}变量，在HTML模板中自定义位置

### 4. 发信系统与路由机制

#### 4.1 发件通道管理
- **功能编号**: F10
- **功能描述**: 多发件通道配置与管理
- **详细功能**:
  - 极光发信API集成
  - 发件人信息管理（名称/签名/头像）
  - 通道测试与验证
  - 通道状态监控（可用性/每日限额/每日恢复限额时间点/黑名单状态）

#### 4.2 发信路由策略
- **功能编号**: F11
- **功能描述**: 智能路由策略确保最佳发送效果
- **详细功能**:
  - 针对邮件任务批次，以及用户可用的发信服务，由可用的发信服务认领任务中的每一次发信子任务
  - 用户可用的发信服务判断
    - 系统配置用户可用的发信服务
    - 用户整体发信额度大于0
    - 用户关联的发信服务为正常状态（非禁用且当日发信额度大于0）
    - 用户关联的发信服务非时间间隔中（每个发信服务会设定发信时间间隔，以保护域名和IP批量暴力发送的问题）
    - 同一个发信服务，关联多个用户或者多个任务调用，按照任务创建时间轮询（即本次完成了任务A，下次认领任务B）


### 5. 私域管理模块（新增）

#### 5.1 基础用户画像
- **功能编号**: F11
- **功能描述**: 构建以邮箱为中心的用户基础画像
- **详细功能**:
  - 用户基础信息整合（来源/标签/互动历史）
  - 互动行为记录（打开/点击/回复）
  - 简单生命周期状态标记（新用户/活跃/沉默/流失）
  - 用户详情页面
  - 用户社媒状态记录
    - 社交媒体
    - 个性签名
    - 粉丝数
    - 发贴数
    - 点赞数
  - 用户社媒内容记录
    - 社交媒体
    - 发文链接
    - 发文内容
    - 发文时间
    - 发文互动
    - 发文评论<list>

#### 5.2 互动历史管理
- **功能编号**: F12
- **功能描述**: 管理与用户的邮件互动历史
- **详细功能**:
  - 邮件往来历史记录
  - 回复内容归档
  - 互动事件时间线
  - 关键互动标记

### 6. 系统管理与安全

#### 6.1 用户权限管理
- **功能编号**: F13
- **功能描述**: 多级用户权限与操作审计
- **详细功能**:
  - 角色权限管理（管理员/操作员/只读用户）
  - 功能权限控制
  - 数据访问权限控制
  - 操作日志审计
  - 登录安全管理

#### 6.2 系统配置
- **功能编号**: F14
- **功能描述**: 系统全局配置与资源管理
- **详细功能**:
  - 系统参数配置
  - 发送限额设置
  - 黑名单管理
  - 系统状态监控
  - 资源使用统计
