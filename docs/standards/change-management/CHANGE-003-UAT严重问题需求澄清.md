# UAT测试严重问题需求澄清

**变更编号**: CHANGE-003  
**提出时间**: 2025-06-04  
**提出人**: UAT测试团队  
**变更类型**: 严重问题澄清  
**优先级**: P0 - 阻塞上线  

## 🚨 问题概述

在严格执行UAT测试过程中，发现EDM系统存在多个严重问题，特别是**P0级邮件发送核心流程**存在关键缺失，必须立即澄清需求并修复。

## 📋 发现的严重问题

### 1. 任务创建流程缺失关键功能

**问题描述**:
- **TC033 模板关联功能**: 在任务创建页面无法找到模板选择器
- **TC034 联系人选择功能**: 在任务创建页面无法找到收件人选择器

**当前状态**: 
- 任务可以创建，但无法关联模板和选择收件人
- 这使得邮件发送功能完全不可用

**需要澄清**:
1. 任务创建时如何关联邮件模板？
2. 任务创建时如何选择收件人（联系人或标签组）？
3. 是否需要重新设计任务创建流程？

**产品经理的反馈**
1. 任务创建时，有下拉框是使用模板集，这里关联「模板管理」的数据，可以关联多个模板id，当关联多个模板id时，均匀随机分配收信人和模板的组合
2. 任务创建时，可以通过基于标签和手动选择联系人（目前前端提供的所有联系人不建议提供）。标签可以组合多个标签包含，以及排除多个标签。这里的标签关联到「标签管理」中的数据，「标签管理」的标签关联到打上该标签的「联系人」。注意，在选择了多个标签包含和排除的组合后，需要显示计划发送人数。对于基于手动选择，则支持下拉选择联系人，下拉框包含「联系人管理」中的所有联系人，注意：前端实现动态加载，避免前端渲染压力过大导致系统卡顿，默认显示最新的10条联系人，可动态翻页。手动选择联系人支持多选，支持输入框中按照用户名和邮箱地址进行模糊匹配
3. 任务创建流程没有问题。邮件群发任务包含主要元素：邮件模板、收信人、发信人（这里目前还没实现，需要补充，即一个账号中，可以有维护多个发信人邮箱地址）、定时发送计划。任务创建后，需要有一个调度管理服务，根据发信人、收信人、邮件模板组合成发送子任务队列，并根据定时计划启动子任务队列。这里接下来的需求会补充发信路由方案、发信服务管理、发信人邮箱创建方案。目前你可以先锁定单一发信人，即我所提供的配置，先跑通流程

### 2. 邮件发送触发机制不明确

**问题描述**:
- **TC039 立即发送功能**: 无法找到邮件发送的触发按钮
- 任务创建后不知道如何实际发送邮件

**当前状态**:
- 任务列表存在，但没有明显的发送触发机制
- 后端可能支持发送，但前端缺少触发界面

**需要澄清**:
1. 邮件发送如何触发？是自动的还是手动的？
2. 发送按钮应该在任务列表还是任务详情中？
3. 是否需要发送确认流程？

**产品经理的反馈**
- 流程同上面问题的反馈第三点，发送机制需要有个调度任务触发

### 3. 后端API异常

**问题描述**:
- **任务API返回504错误**: 后端任务API状态异常

**技术细节**:
```
⚠️ 后端API状态需要检查: { status: 504, ok: false }
```

**需要澄清**:
1. 任务API为何返回504错误？
2. 是否是数据库连接问题？
3. 是否需要重启服务或修复配置？

**产品经理的反馈**
- 这不属于需求或者业务问题，请技术自行排查解决

### 4. 标签管理功能不完整

**问题描述**:
- **TC019 标签创建功能**: 页面超时，功能可能未完整实现

**需要澄清**:
1. 标签管理功能是否已完整开发？
2. 标签与联系人的关联关系是否已实现？
3. 是否需要补充标签管理的完整功能？

**产品经理的反馈**
- 不属于需求或业务问题，前端页面已经看到「标签管理」模块了，请测试认真检查测试用例和实际开发匹配
- 在联系人中，也支持关联标签。不过从用户体验的角度，缺少了批量选择联系人打标的功能，可以作为P1优化项

## 🎯 影响评估

### 功能影响
- **邮件发送核心功能**: 完全不可用 ❌
- **任务管理功能**: 只能创建，无法执行 ❌  
- **标签管理功能**: 基本不可用 ❌

### 测试影响
- **P0级通过率**: 85% ❌（要求100%）
- **P1级通过率**: 22% ❌（要求90%）
- **上线准备度**: 不满足条件 ❌

### 业务影响
- **EDM系统核心价值**: 无法实现邮件营销
- **用户体验**: 严重缺陷
- **系统可用性**: 基本不可用于生产

## 📊 详细测试数据

### P0级未通过的关键测试用例

| 测试用例 | 状态 | 问题描述 |
|---------|------|---------|
| TC033 | ❌ 需确认 | 模板关联功能缺失 |
| TC034 | ❌ 需确认 | 联系人选择功能缺失 |
| TC039 | ❌ 需确认 | 邮件发送触发缺失 |
| TC043 | ❌ 未验证 | 无法完成实际发送验证 |

### 技术问题

1. **API状态异常**: 任务API返回504错误
2. **前端组件缺失**: 关键表单元素无法找到
3. **业务流程不完整**: 从创建到发送的完整链路不通

## 🚦 建议的解决方案

### 立即行动项

1. **修复任务API**:
   - 诊断504错误原因
   - 修复后端服务问题
   - 验证API正常响应

2. **补充任务创建流程**:
   - 添加模板选择器
   - 添加联系人/标签选择器
   - 完善表单验证

3. **实现发送触发机制**:
   - 在任务列表添加发送按钮
   - 实现发送确认流程
   - 提供发送状态反馈

4. **修复标签管理**:
   - 修复标签创建超时问题
   - 完善标签CRUD功能
   - 实现标签与联系人关联

### 中期改进项

1. **完善P1级功能**:
   - 补充缺失的高级功能
   - 优化用户体验
   - 提供完整的功能覆盖

2. **系统集成测试**:
   - 端到端业务流程测试
   - 实际邮件发送验证
   - 性能和稳定性测试

## 🎯 验收标准调整建议

### 短期目标（修复阻塞问题）
- P0级核心邮件发送流程100%可用
- 任务API正常响应
- 基本的CRUD功能完整

### 中期目标（完整功能）
- P0级测试100%通过
- P1级测试≥90%通过
- 实际邮件发送验证成功

## 📞 需要的支持

### 开发团队
1. 立即修复任务API 504错误
2. 补充缺失的前端组件
3. 完善邮件发送流程

### 产品团队
1. 澄清任务创建的具体需求
2. 确认邮件发送的用户体验设计
3. 明确标签管理的功能范围

### 测试团队
1. 配合开发团队进行修复验证
2. 补充完整的回归测试
3. 执行实际邮件发送验证

## 🚨 风险警告

**如果这些问题不能及时解决，EDM系统将无法满足基本的邮件营销需求，不具备上线条件。**

**建议暂停上线计划，优先解决P0级阻塞问题。**

---

**提出人**: UAT测试团队  
**审核人**: 产品负责人  
**执行人**: 开发团队  
**跟踪状态**: 待处理 