# EDM系统验收测试指南

## 🎯 本次修复概述

已成功修复验收测试中发现的7个主要问题：

1. ✅ **编译提醒问题** - 修复数据库连接函数导出
2. ✅ **联系人编辑跳转undefined** - 修复路由配置
3. ✅ **标签关联问题** - ContactForm组件集成真实API
4. ✅ **批量导入联系人标签自动创建** - 新增ContactImport组件
5. ✅ **活动管理页面报错** - 路由配置修复
6. ✅ **创建活动跳转失败** - 路由配置修复
7. ✅ **邮件模板编辑器HTML支持** - 增强TemplateForm组件

## 🚀 启动系统

### 1. 启动后端服务
```bash
cd /Users/tony/Desktop/cursor/EDM
npm start
```

### 2. 启动前端服务
```bash
cd /Users/tony/Desktop/cursor/EDM/src/frontend
npm start
```

### 3. 访问系统
- 前端地址：http://localhost:3001
- 后端API：http://localhost:3000

## 🧪 验收测试步骤

### 测试1：联系人编辑功能
1. 访问联系人列表页面：http://localhost:3001/contacts
2. 点击任意联系人的"编辑"按钮
3. ✅ **验证**：应该正确跳转到编辑页面，URL格式为 `/contacts/edit/:id`

### 测试2：标签功能集成
1. 进入联系人创建页面：http://localhost:3001/contacts/create
2. 在标签选择器中查看可用标签
3. ✅ **验证**：标签应该从API获取，而不是硬编码数据

### 测试3：批量导入功能
1. 在联系人列表页面点击"导入"按钮
2. 上传包含标签列的CSV文件
3. ✅ **验证**：
   - 支持文件预览
   - 不存在的标签会自动创建
   - 显示导入结果统计

### 测试4：活动管理功能
1. 访问活动列表页面：http://localhost:3001/campaigns
2. 点击"创建活动"按钮
3. 点击任意活动的"编辑"按钮
4. ✅ **验证**：所有跳转都应该正常工作

### 测试5：任务管理功能
1. 访问任务列表页面：http://localhost:3001/tasks
2. 测试创建和编辑功能
3. ✅ **验证**：路由跳转正常

### 测试6：模板编辑器HTML功能
1. 访问模板列表页面：http://localhost:3001/templates
2. 创建新模板或编辑现有模板
3. 在编辑器中切换"HTML源码"模式
4. ✅ **验证**：
   - 可以切换富文本和HTML编辑模式
   - HTML模式支持直接粘贴HTML代码
   - 两种模式之间可以正常切换

### 测试7：系统稳定性
1. 检查浏览器控制台是否有错误
2. 测试页面刷新和前进后退功能
3. ✅ **验证**：无编译错误和运行时错误

## 📋 CSV导入文件格式示例

创建一个测试用的CSV文件 `test-contacts.csv`：

```csv
email,username,tags,status,source
john@example.com,john,重要客户,active,import
jane@example.com,jane,潜在客户,active,import
bob@example.com,bob,"重要客户,已成交",active,import
alice@example.com,alice,新标签,active,import
```

## 🔧 故障排除

### 如果后端启动失败
1. 检查数据库连接配置
2. 确保PostgreSQL服务正在运行
3. 检查端口3000是否被占用

### 如果前端启动失败
1. 运行 `npm install` 安装依赖
2. 检查端口3001是否被占用
3. 清除浏览器缓存

### 如果API调用失败
1. 确认后端服务正在运行
2. 检查CORS配置
3. 查看浏览器网络面板的错误信息

## 📞 技术支持

如果在验收测试过程中遇到问题，请：

1. 查看浏览器控制台错误信息
2. 查看后端服务日志
3. 运行验证脚本：`node test-fixes.js`
4. 提供详细的错误描述和重现步骤

## 🎉 验收通过标准

所有以下项目都应该正常工作：

- [ ] 联系人的创建、编辑、删除功能
- [ ] 联系人批量导入功能（包括标签自动创建）
- [ ] 活动管理的完整流程
- [ ] 任务管理功能
- [ ] 模板编辑器的HTML和富文本模式
- [ ] 所有页面路由跳转正常
- [ ] 无编译错误和运行时错误

当所有项目都通过测试时，即可认为本次修复验收通过！ 